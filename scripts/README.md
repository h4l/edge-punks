# OnChainBirds Image Generation Scripts

This directory contains scripts to generate SVG and PNG files for OnChainBirds.

Before running any of these, install npm dependencies from the scripts dir:

```
$ cd scripts
# npm install
```

## SVG

`generate-ocb-svg.mjs` generates the birds' SVG files by executing the
`tokenURI()` function of the OCB Ethereum contract, using web3.js.

Usage example:

```console
$ rm svg/4.svg svg/7.svg

# Some public RPC endpoints may impose limits that prevent tokenURI() from
# executing. infura worked for me though.
$ export WEB3_RPC_URL="https://mainnet.infura.io/v3/xxxxxxxxxx"

$ node scripts/generate-ocb-svg.mjs
2 birds to generate
svg/4.svg
svg/7.svg
```

It only generates SVG files that don't already exist.

## PNG

`generate-ocb-png.mjs` generates PNG images for all birds with a given size,
optionally without a background. As with the SVG generator, it only creates
images that don't already exist.

The PNG images are generated by rendering the SVG images in a headless browser,
via puppeteer. The reason for this is that standalone SVG generators seem to not
produce satisfactory results. In particular, Chrome's SVG rendering is very
good.

The SVG files need to exist before generating PNG files.

Usage example:

```console
# I'm running this in a non-privileged Docker container, so I need --no-sandbox
# to launch Chrome.
export PUPPETEER_OPTIONS='{"executablePath": "/usr/bin/chromium", "args": ["--no-sandbox"]}'

$ rm 400x400-transparent/4.png 400x400-transparent/8.png
$ rm 400x400/4.png 400x400/8.png

$ node scripts/generate-ocb-png.mjs --image-size 400 --transparent
2 birds to generate
400x400-transparent/4.png
400x400-transparent/8.png

$ node scripts/generate-ocb-png.mjs --image-size 400
2 birds to generate
400x400/4.png
400x400/8.png
```
